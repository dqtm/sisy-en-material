% Check Waveshapes for DTP2
% ==========================
clear all, close all, clc;

% Matrix with several waveforms. One waveform per line
LUT_Waveshapes = [ 0,377,751,1118,1474,1816,2141,2446,2729,2987,3218,3422,3596,3740,3854,3938,3992,4017,4014,3985,3932,3856,3760,3647,3518,3376,3225,3067,2904,2739,2574,2411,2253,2102,1958,1823,1698,1583,1480,1388,1307,1237,1178,1127,1086,1052,1024,1002,984,968,953,939,923,906,886,862,834,801,763,720,673,620,564,503,440,374,307,239,171,104,39,-23,-82,-136,-186,-230,-269,-303,-330,-352,-368,-379,-385,-388,-387,-383,-377,-370,-364,-357,-352,-350,-350,-353,-360,-371,-387,-406,-431,-459,-490,-525,-563,-602,-642,-682,-721,-758,-793,-823,-848,-867,-879,-884,-881,-869,-849,-819,-780,-732,-676,-611,-539,-460,-375,-286,-193,-97,0,97,193,286,375,460,539,611,676,732,780,819,849,869,881,884,879,867,848,823,793,758,721,682,642,602,563,525,490,459,431,406,387,371,360,353,350,350,352,357,364,370,377,383,387,388,385,379,368,352,330,303,269,230,186,136,82,23,-39,-104,-171,-239,-307,-374,-440,-503,-564,-620,-673,-720,-763,-801,-834,-862,-886,-906,-923,-939,-953,-968,-984,-1002,-1024,-1052,-1086,-1127,-1178,-1237,-1307,-1388,-1480,-1583,-1698,-1823,-1958,-2102,-2253,-2411,-2574,-2739,-2904,-3067,-3225,-3376,-3518,-3647,-3760,-3856,-3932,-3985,-4014,-4017,-3992,-3938,-3854,-3740,-3596,-3422,-3218,-2987,-2729,-2446,-2141,-1816,-1474,-1118,-751,-377; ...
                   0,234,466,697,926,1152,1373,1590,1801,2006,2204,2395,2578,2752,2917,3072,3217,3352,3476,3588,3690,3780,3859,3926,3981,4025,4057,4078,4087,4086,4074,4052,4019,3977,3926,3866,3798,3722,3639,3549,3453,3352,3245,3134,3020,2902,2782,2659,2536,2411,2285,2160,2036,1912,1790,1671,1553,1438,1326,1217,1112,1011,914,821,733,648,569,494,424,359,298,242,190,143,100,62,28,-3,-29,-52,-72,-88,-102,-112,-120,-126,-129,-130,-129,-127,-124,-119,-113,-106,-99,-91,-83,-74,-65,-57,-48,-39,-31,-23,-16,-9,-3,3,9,13,17,21,23,26,27,28,28,28,27,26,24,22,20,17,14,11,7,4,0,-4,-7,-11,-14,-17,-20,-22,-24,-26,-27,-28,-28,-28,-27,-26,-23,-21,-17,-13,-9,-3,3,9,16,23,31,39,48,57,65,74,83,91,99,106,113,119,124,127,129,130,129,126,120,112,102,88,72,52,29,3,-28,-62,-100,-143,-190,-242,-298,-359,-424,-494,-569,-648,-732,-821,-914,-1011,-1112,-1217,-1326,-1438,-1553,-1671,-1790,-1912,-2036,-2160,-2285,-2411,-2536,-2659,-2782,-2902,-3020,-3134,-3245,-3352,-3453,-3549,-3639,-3722,-3798,-3866,-3926,-3977,-4019,-4052,-4074,-4086,-4087,-4078,-4057,-4025,-3981,-3926,-3859,-3780,-3690,-3588,-3476,-3352,-3217,-3072,-2917,-2752,-2578,-2395,-2204,-2006,-1801,-1590,-1373,-1152,-926,-697,-466,-234; ...
                   0,223,445,665,883,1099,1310,1517,1719,1915,2105,2288,2463,2631,2790,2941,3083,3215,3338,3452,3555,3650,3734,3809,3874,3930,3976,4014,4043,4064,4077,4082,4080,4071,4056,4035,4009,3977,3941,3901,3857,3810,3760,3708,3653,3597,3539,3480,3420,3359,3298,3236,3173,3111,3048,2984,2921,2857,2792,2727,2662,2595,2528,2460,2390,2319,2246,2172,2095,2017,1936,1853,1767,1680,1589,1496,1401,1303,1203,1101,996,890,782,673,562,451,340,228,117,7,-102,-209,-314,-416,-514,-609,-700,-786,-867,-942,-1011,-1073,-1129,-1177,-1218,-1251,-1277,-1294,-1302,-1303,-1294,-1278,-1253,-1221,-1180,-1131,-1076,-1013,-943,-868,-786,-700,-609,-513,-415,-314,-210,-105,0,105,210,314,415,513,609,700,786,868,943,1013,1076,1131,1180,1221,1253,1278,1294,1303,1302,1294,1277,1251,1218,1177,1129,1073,1011,942,867,786,700,609,514,416,314,209,102,-7,-117,-228,-340,-451,-562,-673,-782,-890,-996,-1101,-1203,-1303,-1401,-1496,-1589,-1680,-1767,-1853,-1936,-2017,-2095,-2172,-2246,-2319,-2390,-2460,-2528,-2595,-2662,-2727,-2792,-2857,-2921,-2984,-3048,-3111,-3173,-3236,-3298,-3359,-3420,-3480,-3539,-3597,-3653,-3708,-3760,-3810,-3857,-3901,-3941,-3977,-4009,-4035,-4056,-4071,-4080,-4082,-4077,-4064,-4043,-4014,-3976,-3930,-3874,-3809,-3734,-3650,-3555,-3452,-3338,-3215,-3083,-2941,-2790,-2631,-2463,-2288,-2105,-1915,-1719,-1517,-1310,-1099,-883,-665,-445,-223; ...
                   0,234,467,699,927,1153,1374,1590,1800,2004,2201,2390,2571,2742,2905,3057,3200,3332,3453,3564,3664,3753,3830,3898,3954,4000,4036,4062,4078,4086,4085,4075,4058,4034,4004,3967,3925,3879,3828,3774,3718,3659,3598,3537,3474,3412,3351,3290,3231,3173,3118,3064,3014,2966,2922,2880,2842,2807,2776,2748,2722,2700,2681,2664,2650,2638,2628,2620,2613,2607,2602,2598,2593,2589,2584,2578,2571,2562,2552,2540,2526,2510,2492,2470,2446,2419,2390,2357,2321,2283,2241,2197,2150,2101,2049,1995,1938,1880,1820,1758,1695,1631,1566,1500,1433,1367,1300,1233,1167,1100,1035,970,906,843,780,719,658,599,541,483,427,372,317,263,210,157,104,52,0,-52,-104,-157,-210,-263,-317,-372,-427,-483,-541,-599,-658,-719,-780,-843,-906,-970,-1035,-1100,-1167,-1233,-1300,-1367,-1433,-1500,-1566,-1631,-1695,-1758,-1820,-1880,-1938,-1995,-2049,-2101,-2150,-2197,-2241,-2283,-2321,-2357,-2390,-2419,-2446,-2470,-2492,-2510,-2526,-2540,-2552,-2562,-2571,-2578,-2584,-2589,-2593,-2598,-2602,-2607,-2613,-2620,-2628,-2638,-2650,-2664,-2681,-2700,-2722,-2748,-2776,-2807,-2842,-2880,-2922,-2966,-3014,-3064,-3118,-3173,-3231,-3290,-3351,-3412,-3474,-3537,-3598,-3659,-3718,-3774,-3828,-3879,-3925,-3967,-4004,-4034,-4058,-4075,-4085,-4086,-4078,-4062,-4036,-4000,-3954,-3898,-3830,-3753,-3664,-3564,-3453,-3332,-3200,-3057,-2905,-2742,-2571,-2390,-2201,-2004,-1800,-1590,-1374,-1153,-927,-699,-467,-234; ...
                   0,101,201,301,401,501,601,700,799,897,995,1092,1189,1285,1380,1474,1567,1660,1751,1842,1931,2019,2106,2191,2276,2359,2440,2520,2598,2675,2751,2824,2896,2967,3035,3102,3166,3229,3290,3349,3406,3461,3513,3564,3612,3659,3703,3745,3784,3822,3857,3889,3920,3948,3973,3996,4017,4036,4052,4065,4076,4085,4091,4095,4096,4095,4091,4085,4076,4065,4052,4036,4017,3996,3973,3948,3920,3889,3857,3822,3784,3745,3703,3659,3612,3564,3513,3461,3406,3349,3290,3229,3166,3102,3035,2967,2896,2824,2751,2675,2598,2520,2440,2359,2276,2191,2106,2019,1931,1842,1751,1660,1567,1474,1380,1285,1189,1092,995,897,799,700,601,501,401,301,201,101,0,-101,-201,-301,-401,-501,-601,-700,-799,-897,-995,-1092,-1189,-1285,-1380,-1474,-1567,-1660,-1751,-1842,-1931,-2019,-2106,-2191,-2276,-2359,-2440,-2520,-2598,-2675,-2751,-2824,-2896,-2967,-3035,-3102,-3166,-3229,-3290,-3349,-3406,-3461,-3513,-3564,-3612,-3659,-3703,-3745,-3784,-3822,-3857,-3889,-3920,-3948,-3973,-3996,-4017,-4036,-4052,-4065,-4076,-4085,-4091,-4095,-4096,-4095,-4091,-4085,-4076,-4065,-4052,-4036,-4017,-3996,-3973,-3948,-3920,-3889,-3857,-3822,-3784,-3745,-3703,-3659,-3612,-3564,-3513,-3461,-3406,-3349,-3290,-3229,-3166,-3102,-3035,-2967,-2896,-2824,-2751,-2675,-2598,-2520,-2440,-2359,-2276,-2191,-2106,-2019,-1931,-1842,-1751,-1660,-1567,-1474,-1380,-1285,-1189,-1092,-995,-897,-799,-700,-601,-501,-401,-301,-201,-101];

N = length(LUT_Waveshapes(1,:))     % How many samples in each waveform
aux = 0:1:N-1;                      % Auxiliary index vector

W = length(LUT_Waveshapes(:,1))     % How many different waveforms
W_str ={'Trumpet','Piano','Organ','Oboe','Sinus'};


% Loop to plot Waveforms in time domain
figure(1)
for id=1:W
    plot(aux,LUT_Waveshapes(id,:)), hold on, grid on
end
legend(W_str),xlabel('Sample Index'),ylabel('Amplitude'), hold off


Fs = 48e3;
% Loop to play sounds
for id=1:1:W
    display('Sound nr.:'), id
    %y = LUT_Waveshapes(id,:);      % here get fundamental tone = 187.5Hz
    y = LUT_Waveshapes(id,1:2:end); % here get fundamental tone = 375Hz
    y = repmat(y,1,500);            % repeat the vector 500 times    
    sound(y, Fs);
    pause(3);
end
